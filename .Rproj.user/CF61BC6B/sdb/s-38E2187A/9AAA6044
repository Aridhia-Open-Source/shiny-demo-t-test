{
    "collab_server" : "",
    "contents" : "\nlibrary(shiny)\n\nshinyServer(function(input, output, session) {\n  #Need to edit data to allow selection of platform dataset\n  #data <- reactive({\n  #  inFile <- input$file1 \n  #  if (is.null(inFile)){return(NULL)} \n  #  read.csv(inFile$datapath, header=input$header, sep=input$sep, \n  #           quote=input$quote)\n  #})\n  \n  # reading file from data folder\n  data <- reactive({\n    inFile <- input$file1 \n    if (is.null(inFile)){return(NULL)}\n    if (inFile == \"\"){return(NULL)}\n    read.csv(file.path(\"data\", inFile), header=input$header, sep=input$sep, \n             quote=input$quote)\n  })\n  \n  \n  # Updata value user could select\n  observe({\n    updateSelectInput(\n      session,\n      \"var1\",\n      choices=names(data()))\n    \n  })\n  # Updata value user could select\n  observe({\n    updateSelectInput(\n      session,\n      \"var2\",\n      choices=names(data()))\n    \n  })\n  \n  \n  \n  # Output a data table for the upload tab page\n  output$contents <- renderTable({\n    inFile <- input$file1 \n    if (is.null(inFile))\n      return(NULL)\n    if (inFile == \"\") return(NULL)\n    read.csv(file.path(\"data\", inFile), header=input$header, sep=input$sep, quote=input$quote)\n    \n  })\n  \n  num_var <- reactive({\n    data()[, input$var1]\n  })\n  \n  cat_var <- reactive({\n    data()[, input$var2]\n  })\n  \n  output$group1_ui <- renderUI({\n    if(is.null(cat_var())) return(NULL)\n    selectInput(\"group1\", \"Choose first group\", choices = unique(cat_var()))\n  })\n  \n  output$group2_ui <- renderUI({\n    if(is.null(cat_var())) return(NULL)\n    selectInput(\"group2\", \"Choose second group\", choices = unique(cat_var()))\n  })\n  \n  cat1 <- reactive({\n    input$group1\n  })\n  \n  cat2 <- reactive({\n    input$group2\n  })\n  \n  variable1 <- reactive({\n    if (input$sample == \"oneSamp\") {\n      return(num_var)\n    }\n    if (input$sample == \"twoSamp\") {\n      var1 <- num_var()[cat_var() == cat1()]\n      return(var1)\n    }\n  })\n  \n  variable2 <- reactive({\n    var2 <- data()[,input$var2]\n    if (is.null(var2)){return(NULL)}\n    out <- num_var()[cat_var() == cat2()]\n    return(out)\n  })\n  \n  \n  # Output a histogram for the variables user chose\n  output$graph <- renderPlot({\n    var1 <- variable1()\n    var2 <- variable2()\n    if (is.null(var1)){return(NULL)}\n    if (is.null(var2)){return(NULL)}\n    graph2 <- ifelse(input$sample == 'oneSamp', FALSE, TRUE)\n    p1 <- hist(var1, breaks = input$bins)\n    p2 <- hist(var2, breaks = input$bins)\n    plot(p1, col=rgb(0,0,1,1/4))\n    if(input$sample == 'twoSamp')\n      plot(p2, col=rgb(1,0,0,1/4),add = graph2)\n  })\n  \n  # Output of discriptive summary of this variable\n  output$disc <-  renderPrint({\n    Data <- data()\n    if (is.null(Data)){return(NULL)}\n    summary(Data)\n  })\n  \n  # Output of the data structure\n  output$str <- renderPrint({\n    Data <- data()\n    if (is.null(Data)){return(NULL)}\n    str(Data)\n  })\n  \n  \n  \n  # Create a one sample and two sample t-test reactive function\n  ttestout <- reactive({\n    var1 <- variable1()\n    var2 <- variable2()\n    conf <- input$conf\n    if (is.null(var1)){return(NULL)}\n    t1 <- t.test(var1, alternative = input$tail, mu = input$test, conf.level = conf)\n    #var2 <- data()[,input$var2]\n    if (is.null(var2)){return(NULL)}\n    ve <- ifelse(input$varequal == 'y', TRUE, FALSE)\n    t2 <- t.test(var1, var2, alternative = input$tail, var.equal = ve, conf.level = conf)\n    if(input$sample == \"oneSamp\") {return(t1)}\n    if(input$sample == \"twoSamp\") {return(t2)}\n    \n  })\n  \n  # Output of one sample t value of t-test\n  output$tvalue <- renderPrint({\n    vals <- ttestout()\n    if (is.null(vals)){return(NULL)}\n    vals$statistic\n  })\n  \n  # Output of p value\n  output$pvalue <- renderPrint({\n    vals <- ttestout()\n    if (is.null(vals)){return(NULL)}\n    vals$p.value \n  })\n  \n  # Output of key statistical parameters\n  output$parametric <- renderTable({\n    var1 <- data()[,input$var1]\n    if (is.null(var)){return(NULL)}\n    var2 <- data()[,input$var2]\n    if (is.null(var)){return(NULL)}\n    mean1 <- mean(var1)\n    mean2 <- mean(var2)\n    standard_deviation1 <- sd(var1)\n    standard_deviation2 <- sd(var2)\n    standard_error1 <- sd(var1)/sqrt(length(var1))\n    standard_error2 <- sd(var2)/sqrt(length(var2))\n    parametric1 <- data.frame(mean = mean1, \n                              standard_deviation=standard_deviation1, \n                              standard_error=standard_error1)\n    rownames(parametric1) <- input$var1\n    parametric2 <- data.frame(mean = mean2, \n                              standard_deviation=standard_deviation2, \n                              standard_error=standard_error2)\n    rownames(parametric2) <- input$var2\n    if(input$sample == \"oneSamp\") {return(parametric1)}\n    if(input$sample == \"twoSamp\") {return(rbind(parametric1,parametric2))}\n  })\n  \n  \n  \n})",
    "created" : 1490353642550.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2190827641",
    "id" : "9AAA6044",
    "lastKnownWriteTime" : 1490353750,
    "last_content_update" : 1490353750663,
    "path" : "~/git/t_test/workspace/mini-apps/t_test/server.R",
    "project_path" : "workspace/mini-apps/t_test/server.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}